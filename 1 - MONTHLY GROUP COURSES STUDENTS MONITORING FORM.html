<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bulk Student Progress Report</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            background: white;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 24px;
        }
        
        .header-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
            padding: 20px;
            background: #ecf0f1;
            border-radius: 6px;
        }
        
        .field-group {
            display: flex;
            flex-direction: column;
        }
        
        label {
            font-weight: 600;
            color: #34495e;
            margin-bottom: 5px;
            font-size: 13px;
        }
        
        input[type="text"],
        input[type="number"],
        select,
        textarea {
            padding: 8px;
            border: 2px solid #ddd;
            border-radius: 4px;
            font-size: 13px;
            transition: border-color 0.3s;
            font-family: inherit;
        }
        
        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #3498db;
            background: #f0f8ff;
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 6px;
        }
        
        .student-count {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .btn-container {
            display: flex;
            gap: 10px;
        }
        
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-add {
            background: #27ae60;
            color: white;
        }
        
        .btn-add:hover {
            background: #229954;
        }
        
        .btn-remove {
            background: #e74c3c;
            color: white;
        }
        
        .btn-remove:hover {
            background: #c0392b;
        }
        
        .table-container {
            overflow-x: auto;
            margin-bottom: 30px;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }
        
        .data-table th {
            background: #34495e;
            color: white;
            padding: 12px 8px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
            white-space: nowrap;
        }
        
        .data-table td {
            padding: 8px;
            border: 1px solid #ddd;
            background: white;
        }
        
        .data-table tbody tr:hover {
            background: #f8f9fa;
        }
        
        .data-table input[type="text"],
        .data-table input[type="number"],
        .data-table select {
            width: 100%;
            border: 1px solid #ddd;
            padding: 6px;
        }
        
        .data-table textarea {
            width: 100%;
            min-height: 60px;
            resize: vertical;
            border: 1px solid #ddd;
            padding: 6px;
        }
        
        .col-narrow {
            width: 80px;
        }
        
        .col-medium {
            width: 120px;
        }
        
        .col-wide {
            width: 150px;
        }
        
        .col-extra-wide {
            min-width: 300px;
        }
        
        .remove-btn {
            padding: 5px 10px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .remove-btn:hover {
            background: #c0392b;
        }
        
        .section-header {
            background: #3498db !important;
            color: white !important;
            font-size: 14px;
            text-align: center !important;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        .btn-primary {
            background: #3498db;
            color: white;
            padding: 12px 30px;
            font-size: 15px;
        }
        
        .btn-primary:hover {
            background: #2980b9;
        }
        
        .btn-secondary {
            background: #95a5a6;
            color: white;
            padding: 12px 30px;
            font-size: 15px;
        }
        
        .btn-secondary:hover {
            background: #7f8c8d;
        }
        
        .btn-success {
            background: #27ae60;
            color: white;
            padding: 12px 30px;
            font-size: 15px;
        }
        
        .btn-success:hover {
            background: #229954;
        }
        
        .help-text {
            background: #fff3cd;
            border: 1px solid #ffc107;
            color: #856404;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            font-size: 13px;
        }
        
        .help-text strong {
            display: block;
            margin-bottom: 5px;
        }
        
        @media print {
            .controls,
            .action-buttons,
            .help-text,
            .remove-btn {
                display: none;
            }
            
            .data-table {
                font-size: 10px;
            }
            
            .data-table th,
            .data-table td {
                padding: 4px;
            }
        }
        
        .alert {
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
            display: none;
            text-align: center;
            font-weight: 600;
        }
        
        .alert-success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Monthly Progress & Risk Alert Report - Bulk Entry</h1>
        
        <div class="help-text">
            <strong>üí° Speed Tip:</strong> Use TAB to move quickly between fields. Fill each column top-to-bottom, then move to the next column. This way you can quickly enter all names, then all attendance rates, etc. Save detailed notes for last!
        </div>
        
        <div class="header-info">
            <div class="field-group">
                <label for="month">Month:</label>
                <input type="text" id="month" placeholder="e.g., January 2025">
            </div>
            <div class="field-group">
                <label for="teacher">Teacher:</label>
                <input type="text" id="teacher">
            </div>
            <div class="field-group">
                <label for="course">Course/Level:</label>
                <input type="text" id="course">
            </div>
        </div>
        
        <div class="controls">
            <div class="student-count">Students: <span id="studentCount">0</span></div>
            <div class="btn-container">
                <button class="btn-add" onclick="addStudent()">+ Add Student</button>
                <button class="btn-remove" onclick="removeLastStudent()">- Remove Last</button>
            </div>
        </div>
        
        <div class="table-container">
            <table class="data-table">
                <thead>
                    <tr>
                        <th class="col-narrow">#</th>
                        <th class="col-wide">Student Name</th>
                        <th class="col-medium">Progress Status</th>
                        <th class="col-narrow">Attendance %</th>
                        <th class="col-medium">Commitment</th>
                        <th class="col-narrow">Speaking (1-5)</th>
                        <th class="col-narrow">Listening (1-5)</th>
                        <th class="col-narrow">Reading (1-5)</th>
                        <th class="col-narrow">Writing (1-5)</th>
                        <th class="col-wide">Test Scores</th>
                        <th class="col-medium">Primary Issue</th>
                        <th class="col-medium">Action Taken</th>
                        <th class="col-extra-wide">Teacher Notes</th>
                        <th class="col-narrow">Remove</th>
                    </tr>
                </thead>
                <tbody id="studentTableBody">
                    <!-- Rows will be added here -->
                </tbody>
            </table>
        </div>
        
        <div class="alert alert-success" id="saveAlert">
            Data exported successfully!
        </div>
        
        <div class="action-buttons">
            <button class="btn-add" onclick="addMultipleStudents()">+ Add 5 Students</button>
            <button class="btn-success" onclick="saveForm()">üíæ Save Form Data</button>
            <button class="btn-success" onclick="document.getElementById('loadFile').click()">üìÇ Load Form Data</button>
            <button class="btn-primary" onclick="downloadHTML()">‚¨áÔ∏è Download This Form (HTML)</button>
            <button class="btn-primary" onclick="window.print()">Print Report</button>
            <button class="btn-success" onclick="exportData()">Export Data (JSON)</button>
            <button class="btn-secondary" onclick="clearAll()">Clear All</button>
        </div>
        
        <input type="file" id="loadFile" accept=".json" style="display: none;" onchange="loadForm(event)">
    </div>
    
    <script>
        let studentCounter = 0;
        
        function addStudent() {
            studentCounter++;
            const tbody = document.getElementById('studentTableBody');
            const row = tbody.insertRow();
            
            row.innerHTML = `
                <td>${studentCounter}</td>
                <td><input type="text" id="name-${studentCounter}" placeholder="Student name"></td>
                <td>
                    <select id="progress-${studentCounter}">
                        <option value="">Select...</option>
                        <option value="YES">‚úì YES - On track</option>
                        <option value="AT RISK">‚ö† AT RISK</option>
                        <option value="SERIOUS CONCERN">‚ùå SERIOUS CONCERN</option>
                    </select>
                </td>
                <td><input type="text" id="attendance-${studentCounter}" placeholder="85%"></td>
                <td>
                    <select id="commitment-${studentCounter}">
                        <option value="">Select...</option>
                        <option value="Excellent">Excellent</option>
                        <option value="Adequate">Adequate</option>
                        <option value="Problem">Problem</option>
                    </select>
                </td>
                <td><input type="number" id="speaking-${studentCounter}" min="1" max="5" placeholder="3"></td>
                <td><input type="number" id="listening-${studentCounter}" min="1" max="5" placeholder="3"></td>
                <td><input type="number" id="reading-${studentCounter}" min="1" max="5" placeholder="3"></td>
                <td><input type="number" id="writing-${studentCounter}" min="1" max="5" placeholder="3"></td>
                <td><input type="text" id="test-${studentCounter}" placeholder="Quiz: 75%"></td>
                <td>
                    <select id="issue-${studentCounter}">
                        <option value="">Select...</option>
                        <option value="None">No issues</option>
                        <option value="Ability">Ability/Aptitude</option>
                        <option value="Effort">Effort/Motivation</option>
                        <option value="Attendance">Attendance</option>
                        <option value="Behavior">Behavior</option>
                        <option value="External">External factors</option>
                    </select>
                </td>
                <td>
                    <select id="action-${studentCounter}">
                        <option value="">Select...</option>
                        <option value="None">No action needed</option>
                        <option value="Tutoring">Tutoring offered</option>
                        <option value="Parent contacted">Parent contacted</option>
                        <option value="Materials provided">Materials provided</option>
                        <option value="Meeting recommended">Meeting recommended</option>
                    </select>
                </td>
                <td><textarea id="notes-${studentCounter}" rows="3" placeholder="Specific concerns, observations, evidence..."></textarea></td>
                <td><button class="remove-btn" onclick="removeStudent(this)">‚úï</button></td>
            `;
            
            updateStudentCount();
            enableAutoExpand();
        }
        
        function addMultipleStudents() {
            for (let i = 0; i < 5; i++) {
                addStudent();
            }
        }
        
        function removeStudent(btn) {
            const row = btn.closest('tr');
            row.remove();
            renumberRows();
            updateStudentCount();
        }
        
        function removeLastStudent() {
            const tbody = document.getElementById('studentTableBody');
            if (tbody.rows.length > 0) {
                tbody.deleteRow(tbody.rows.length - 1);
                updateStudentCount();
            }
        }
        
        function renumberRows() {
            const tbody = document.getElementById('studentTableBody');
            Array.from(tbody.rows).forEach((row, index) => {
                row.cells[0].textContent = index + 1;
            });
        }
        
        function updateStudentCount() {
            const count = document.getElementById('studentTableBody').rows.length;
            document.getElementById('studentCount').textContent = count;
        }
        
        function clearAll() {
            if (confirm('Are you sure you want to clear all data?')) {
                document.getElementById('studentTableBody').innerHTML = '';
                document.getElementById('month').value = '';
                document.getElementById('teacher').value = '';
                document.getElementById('course').value = '';
                studentCounter = 0;
                updateStudentCount();
            }
        }
        
        function downloadHTML() {
            const htmlContent = document.documentElement.outerHTML;
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'student-monitoring-form.html';
            link.click();
            URL.revokeObjectURL(url);
            
            const alert = document.getElementById('saveAlert');
            alert.textContent = 'HTML form downloaded! You can now open it anytime in your browser.';
            alert.style.display = 'block';
            setTimeout(() => { alert.style.display = 'none'; }, 4000);
        }
        
        function saveForm() {
            const data = collectFormData();
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            const month = data.reportInfo.month || 'untitled';
            link.download = `student-form-${month.replace(/\s+/g, '-')}-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
            
            const alert = document.getElementById('saveAlert');
            alert.textContent = 'Form saved successfully!';
            alert.style.display = 'block';
            setTimeout(() => { alert.style.display = 'none'; }, 3000);
        }
        
        function loadForm(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    // Clear existing data
                    document.getElementById('studentTableBody').innerHTML = '';
                    studentCounter = 0;
                    
                    // Load header info
                    document.getElementById('month').value = data.reportInfo.month || '';
                    document.getElementById('teacher').value = data.reportInfo.teacher || '';
                    document.getElementById('course').value = data.reportInfo.course || '';
                    
                    // Load students
                    data.students.forEach(student => {
                        addStudent();
                        const id = studentCounter;
                        
                        document.getElementById(`name-${id}`).value = student.name || '';
                        document.getElementById(`progress-${id}`).value = student.progressStatus || '';
                        document.getElementById(`attendance-${id}`).value = student.attendance || '';
                        document.getElementById(`commitment-${id}`).value = student.commitment || '';
                        document.getElementById(`speaking-${id}`).value = student.skills.speaking || '';
                        document.getElementById(`listening-${id}`).value = student.skills.listening || '';
                        document.getElementById(`reading-${id}`).value = student.skills.reading || '';
                        document.getElementById(`writing-${id}`).value = student.skills.writing || '';
                        document.getElementById(`test-${id}`).value = student.testScores || '';
                        document.getElementById(`issue-${id}`).value = student.primaryIssue || '';
                        document.getElementById(`action-${id}`).value = student.actionTaken || '';
                        document.getElementById(`notes-${id}`).value = student.teacherNotes || '';
                    });
                    
                    const alert = document.getElementById('saveAlert');
                    alert.textContent = 'Form loaded successfully!';
                    alert.style.display = 'block';
                    setTimeout(() => { alert.style.display = 'none'; }, 3000);
                    
                } catch (error) {
                    alert('Error loading file: ' + error.message);
                }
            };
            reader.readAsText(file);
            
            // Reset file input
            event.target.value = '';
        }
        
        function collectFormData() {
            const month = document.getElementById('month').value;
            const teacher = document.getElementById('teacher').value;
            const course = document.getElementById('course').value;
            
            const students = [];
            const tbody = document.getElementById('studentTableBody');
            
            Array.from(tbody.rows).forEach((row, index) => {
                const id = index + 1;
                
                const studentData = {
                    number: id,
                    name: document.getElementById(`name-${id}`)?.value || '',
                    progressStatus: document.getElementById(`progress-${id}`)?.value || '',
                    attendance: document.getElementById(`attendance-${id}`)?.value || '',
                    commitment: document.getElementById(`commitment-${id}`)?.value || '',
                    skills: {
                        speaking: document.getElementById(`speaking-${id}`)?.value || '',
                        listening: document.getElementById(`listening-${id}`)?.value || '',
                        reading: document.getElementById(`reading-${id}`)?.value || '',
                        writing: document.getElementById(`writing-${id}`)?.value || ''
                    },
                    testScores: document.getElementById(`test-${id}`)?.value || '',
                    primaryIssue: document.getElementById(`issue-${id}`)?.value || '',
                    actionTaken: document.getElementById(`action-${id}`)?.value || '',
                    teacherNotes: document.getElementById(`notes-${id}`)?.value || ''
                };
                
                students.push(studentData);
            });
            
            return {
                reportInfo: {
                    month,
                    teacher,
                    course,
                    date: new Date().toISOString()
                },
                students
            };
        }
        
        function exportData() {
            const data = collectFormData();
            const month = data.reportInfo.month || 'report';
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `progress-report-${month.replace(/\s+/g, '-')}-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
            
            const alert = document.getElementById('saveAlert');
            alert.textContent = 'Data exported successfully!';
            alert.style.display = 'block';
            setTimeout(() => { alert.style.display = 'none'; }, 3000);
        }
        
        function enableAutoExpand() {
            document.querySelectorAll('textarea').forEach(textarea => {
                textarea.removeEventListener('input', autoExpand);
                textarea.addEventListener('input', autoExpand);
            });
        }
        
        function autoExpand() {
            this.style.height = 'auto';
            this.style.height = this.scrollHeight + 'px';
        }
        
        // Add keyboard navigation enhancement
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && e.target.tagName !== 'TEXTAREA') {
                e.preventDefault();
                const inputs = Array.from(document.querySelectorAll('input, select, textarea')).filter(el => {
                    return el.offsetParent !== null;
                });
                const currentIndex = inputs.indexOf(e.target);
                if (currentIndex > -1 && currentIndex < inputs.length - 1) {
                    inputs[currentIndex + 1].focus();
                }
            }
        });
        
        // Initialize with 3 students
        for (let i = 0; i < 3; i++) {
            addStudent();
        }
    </script>
</body>
</html>